https://github.com/libjpeg-turbo/libjpeg-turbo/commit/1bfb0b5247f4fc8f6677639781ce468543490216

diff --git a/rdppm.c b/rdppm.c
index c0c0962..4547acd 100644
--- a/rdppm.c
+++ b/rdppm.c
@@ -299,6 +299,8 @@ get_word_rgb_row (j_compress_ptr cinfo, cjpeg_source_ptr sinfo)
 }
 
 
+// Redefine MAX here for support CVE-2020-13790
+#define MAX(a, b)	((a) > (b) ? (a) : (b))
 /*
  * Read the file header; return image size and component count.
  */
@@ -425,7 +427,7 @@ start_input_ppm (j_compress_ptr cinfo, cjpeg_source_ptr sinfo)
     /* On 16-bit-int machines we have to be careful of maxval = 65535 */
     source->rescale = (JSAMPLE *)
       (*cinfo->mem->alloc_small) ((j_common_ptr) cinfo, JPOOL_IMAGE,
-                                  (size_t) (((long) maxval + 1L) *
+                                  (size_t)(((long)MAX(maxval, 255) + 1L) *
                                             sizeof(JSAMPLE)));
     half_maxval = maxval / 2;
     for (val = 0; val <= (long) maxval; val++) {
