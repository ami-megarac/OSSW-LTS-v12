diff --color -Naur a/fs/ext4/inline.c b/fs/ext4/inline.c
--- a/fs/ext4/inline.c	2021-10-19 15:21:14.553594972 +0800
+++ b/fs/ext4/inline.c	2021-10-19 15:39:46.115789426 +0800
@@ -750,6 +750,12 @@
 	ext4_write_lock_xattr(inode, &no_expand);
 	BUG_ON(!ext4_has_inline_data(inode));
 
+	/*
+	 * ei->i_inline_off may have changed since ext4_write_begin()
+	 * called ext4_try_to_write_inline_data()
+	 */
+	(void) ext4_find_inline_data_nolock(inode);
+	
 	kaddr = kmap_atomic(page);
 	ext4_write_inline_data(inode, &iloc, kaddr, pos, len);
 	kunmap_atomic(kaddr);
