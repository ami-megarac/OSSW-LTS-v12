--- linux_patch025/fs/nfs/nfs4proc.c	2020-11-11 14:38:18.741084010 +0800
+++ linux/fs/nfs/nfs4proc.c	2020-11-12 17:34:49.015536381 +0800
@@ -5795,8 +5795,6 @@
 		return ret;
 	if (!(fattr.valid & NFS_ATTR_FATTR_V4_SECURITY_LABEL))
 		return -ENOENT;
-	if (buflen < label.len)
-		return -ERANGE;
 	return 0;
 }
 
--- linux_patch025/fs/nfs/nfs4xdr.c	2020-11-11 14:38:21.589078088 +0800
+++ linux/fs/nfs/nfs4xdr.c	2020-11-12 17:36:12.963585836 +0800
@@ -4169,7 +4169,11 @@
 			return -EIO;
 		if (len < NFS4_MAXLABELLEN) {
 			if (label) {
-				memcpy(label->label, p, len);
+				if (label->len) {
+					if (label->len < len)
+						return -ERANGE;
+					memcpy(label->label, p, len);
+				}
 				label->len = len;
 				label->pi = pi;
 				label->lfs = lfs;
