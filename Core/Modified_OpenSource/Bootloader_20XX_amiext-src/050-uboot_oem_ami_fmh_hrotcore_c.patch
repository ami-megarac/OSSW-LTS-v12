--- uboot/oem/ami/fmh/hrotcore.c	2021-07-06 15:35:44.585693114 +0800
+++ uboot.new/oem/ami/fmh/hrotcore.c	2021-07-07 11:20:13.089778853 +0800
@@ -1,9 +1,12 @@
 # include <common.h>
+# include <stdlib.h>
 # include <config.h>
 # include <command.h>
 # include <flash.h>
 # include "cmd.h"
 # include <oem/ami/fmh/fmh.h>
+
+#include <environment.h>
 # include "hrot_ifc.h"
 #include "u-boot/sha256.h"
 #include "u-boot/rsa.h"
@@ -23,6 +26,7 @@
 static sha256_context ctx;
 static UINT32 boot_fmh_location,product_info_offset=0;
 static char placeToHash[HASH_BLK_SIZE];
+static UINT32 totalsize=0;
 
 void
 hrot_start(){
@@ -96,7 +100,8 @@
                         sha256_update(&ctx, hash_data, hs_size);
                         hash_start += hs_size;
                 }
-
+		totalsize=totalsize+hs_size;
+		env_set_hex("blob_length",totalsize);
 	}
         return 0;
 }
@@ -124,6 +129,9 @@
         char    linebuf[16384] = {0}, linebuf1[1024] = {0};
         void *buf=NULL, *buf1=NULL;
         int ret =0;
+	char blob_data[65]= {0};
+	int i=0, retval=0;
+
 		int sig_length;
 		char identifier[8];
 		struct spi_flash *flash;
@@ -140,7 +148,6 @@
 		}
         sha256_finish(&ctx, output);
 
-
 	   rc = spi_flash_read(flash,keyInfo, KEY_INFO_LENGTH*4, linebuf);
         buf = (rc == ERR_OK) ? linebuf : (void*)keyInfo;
 
@@ -150,6 +157,8 @@
 			printf("unable to find signature start identifier :( \n");
 			return -1;
 		}
+
+		env_set_hex("blob_base",sigaddr);
 	
 		sigaddr +=sizeof(START_IDENTIFIER);
 		/* scan through hash area and find the proper hash for firmware image*/
@@ -194,6 +203,18 @@
                 printf("%s", key_data);
                 printf("%s", sig);
         }
+
+        for(i=0;i<size/2;i++)
+        {
+                retval=snprintf(blob_data+(i*2),3,"%02x",output[i]);
+                if(retval < 0 || retval >= 3)
+                {
+                        return retval;
+                }
+
+        }
+        env_set("blob_data",blob_data);
+        env_save();
         ret = rsa_get_pub_key_uboot_verify(key_data, sig, sig_length, output, size);
         return ret;
 }
